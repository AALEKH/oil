# Debian bullseye has podman
image: debian/bullseye
packages:
  # for publishing
  - python2
  - zip
  # podman and its missing dependencies
  - podman
  - uidmap
  - slirp4netns

secrets:
  - 2678474d-b22b-449f-a19a-16cb403c94cd

tasks:
  - dev-minimal: |
      cd oil
      soil/host-shim.sh run-task podman $PWD dev-minimal

  # Relies on SSH key, so do it outside the container
  - publish-html: |
      cd oil
      soil/sourcehut.sh publish-html-assuming-ssh-key
